<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>A tiny universe just for you üå∑</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Quicksand:wght@300;400;600&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background: linear-gradient(145deg, #1a1b2f 0%, #2a1e2c 100%);
            font-family: 'Quicksand', sans-serif;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        .float-heart {
            position: fixed;
            color: rgba(255, 192, 203, 0.3);
            font-size: 20px;
            animation: float 8s linear infinite;
            user-select: none;
            pointer-events: none;
            z-index: 0;
        }

        @keyframes float {
            0% { transform: translateY(100vh) scale(0.5); opacity: 0.8; }
            100% { transform: translateY(-100px) scale(1.5); opacity: 0; }
        }

        .dream-box {
            background: rgba(255, 245, 240, 0.9);
            backdrop-filter: blur(15px);
            border-radius: 48px;
            padding: 40px 30px;
            max-width: 800px;
            width: 100%;
            box-shadow: 
                0 20px 40px rgba(0,0,0,0.2),
                0 0 0 2px rgba(255, 220, 220, 0.5),
                0 0 40px rgba(255, 180, 180, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.5);
            position: relative;
            z-index: 10;
        }

        .orb {
            position: absolute;
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, rgba(255,200,200,0.4), rgba(255,150,150,0.1));
            filter: blur(30px);
            z-index: 0;
        }

        .orb-1 { top: -20px; left: -20px; }
        .orb-2 { bottom: -30px; right: -20px; background: radial-gradient(circle at 70% 70%, rgba(200,180,255,0.4), rgba(150,150,255,0.1)); }

        .creature-circle {
            width: 260px;
            height: 260px;
            margin: 0 auto 25px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px;
            box-shadow: 
                0 0 0 5px rgba(255, 255, 255, 0.8),
                0 0 0 12px rgba(255, 180, 190, 0.3);
        }

        #soul-gif {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
            transition: opacity 0.5s ease;
            border: 3px solid white;
        }

        .whisper-title {
            font-family: 'Dancing Script', cursive;
            font-size: 2.8rem;
            background: linear-gradient(135deg, #c63b4a, #b23b4a, #9e3b4a);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-align: center;
            margin-bottom: 10px;
            letter-spacing: 2px;
            text-shadow: 2px 2px 10px rgba(255, 200, 200, 0.5);
            line-height: 1.2;
        }

        .button-garden {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 35px;
            margin-top: 40px;
            flex-wrap: wrap;
            position: relative;
        }

        /* FIX: Completely redesigned buttons for iOS */
        .bloom-btn {
            border: none;
            border-radius: 120px;
            font-family: 'Quicksand', sans-serif;
            font-weight: 700;
            font-size: 1.3rem;
            padding: 18px 45px;
            
            /* CRITICAL FIXES FOR iOS */
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 160px;
            min-height: 65px;
            background: transparent; /* Let the gradient show through */
            color: white;
            border: 2px solid rgba(255,255,255,0.8);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            
            /* Remove problematic properties */
            white-space: nowrap;
            -webkit-appearance: none;
            appearance: none;
            -webkit-border-radius: 120px;
            
            /* Ensure full clickability */
            position: relative;
            z-index: 9999;
            pointer-events: auto !important;
            touch-action: manipulation;
            -webkit-touch-callout: none;
        }

        /* Separate background styling */
        #yes-blossom {
            background: linear-gradient(145deg, #ff8a9c, #ff6b81);
            border: 2px solid #fff5e6;
            box-shadow: 0 10px 30px #ffb6c1;
        }

        #yes-blossom:active {
            transform: scale(0.95);
            background: linear-gradient(145deg, #ff6b81, #ff8a9c);
        }

        #no-blossom {
            background: linear-gradient(145deg, #6c5b7b, #56506e);
            border: 2px solid #cfb3cd;
        }

        #no-blossom:active {
            transform: scale(0.95);
            background: linear-gradient(145deg, #56506e, #6c5b7b);
        }

        .sparkle {
            position: absolute;
            pointer-events: none;
            font-size: 12px;
            animation: twinkle 1s ease-out forwards;
        }

        @keyframes twinkle {
            0% { transform: scale(0.2) rotate(0deg); opacity: 1; }
            100% { transform: scale(1.8) rotate(45deg); opacity: 0; }
        }

        .cloud-message {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(44, 62, 80, 0.95);
            backdrop-filter: blur(8px);
            color: #fff9e6;
            padding: 16px 32px;
            border-radius: 60px;
            font-size: 1.1rem;
            font-weight: 500;
            letter-spacing: 1px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2), 0 0 0 2px rgba(255,215,215,0.5);
            z-index: 999;
            opacity: 0;
            transition: opacity 0.3s ease;
            border: 1px solid rgba(255,255,255,0.6);
            display: flex;
            align-items: center;
            gap: 10px;
            pointer-events: none;
        }

        .cloud-message.show {
            opacity: 1;
            transform: translateX(-50%) translateY(-10px);
        }

        .date-card {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            background: linear-gradient(145deg, #fff9f0, #ffe8e8);
            padding: 40px;
            border-radius: 40px;
            box-shadow: 0 30px 60px rgba(210, 80, 100, 0.4), 0 0 0 6px rgba(255, 220, 220, 0.6);
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            max-width: 500px;
            width: 90%;
            border: 2px solid white;
            text-align: center;
            pointer-events: auto;
        }

        .date-card.show {
            opacity: 1;
            visibility: visible;
            transform: translate(-50%, -50%) scale(1);
        }

        .date-card .pizza-emoji {
            font-size: 70px;
            margin-bottom: 20px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        .date-card h2 {
            font-family: 'Dancing Script', cursive;
            font-size: 2.5rem;
            color: #c4455a;
            margin-bottom: 25px;
            text-shadow: 2px 2px 0 #ffe6e6;
        }

        .date-message {
            background: rgba(255, 255, 255, 0.7);
            padding: 25px;
            border-radius: 25px;
            margin: 20px 0;
            border: 2px dashed #ff9a9e;
        }

        .date-message p {
            font-size: 1.2rem;
            line-height: 1.8;
            color: #4a3b4a;
            font-weight: 500;
        }

        .hero-badge {
            background: #ffd700;
            color: #2a1e2c;
            padding: 12px 25px;
            border-radius: 50px;
            display: inline-block;
            margin-top: 20px;
            font-weight: bold;
            font-size: 1.2rem;
            box-shadow: 0 5px 0 #b8860b;
        }

        .close-date {
            margin-top: 30px;
            padding: 15px 35px;
            background: linear-gradient(145deg, #ff8a9c, #ff6b81);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            border: 2px solid white;
            transition: all 0.3s ease;
            -webkit-appearance: none;
            appearance: none;
        }

        .close-date:active {
            transform: scale(0.95);
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(8px);
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .music-charm {
            position: fixed;
            top: 25px;
            right: 25px;
            width: 55px;
            height: 55px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid rgba(255, 120, 140, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            cursor: pointer;
            backdrop-filter: blur(5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            z-index: 10000;
            color: #6b4e5e;
            -webkit-tap-highlight-color: transparent;
            -webkit-appearance: none;
            appearance: none;
        }

        .music-charm:active {
            transform: scale(0.9);
        }

        .secret-confession {
            text-align: center;
            margin-top: 20px;
            min-height: 40px;
            color: #8a5a6a;
            font-weight: 500;
            font-size: 1.1rem;
            padding: 10px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 30px;
            backdrop-filter: blur(5px);
            transition: all 0.5s ease;
        }

        /* iOS specific mobile fixes */
        @media (max-width: 600px) {
            .dream-box { padding: 25px 20px; }
            .whisper-title { font-size: 2rem; }
            .button-garden { 
                gap: 20px;
                flex-direction: column;
            }
            .bloom-btn { 
                padding: 16px 35px;
                font-size: 1.2rem;
                min-width: 200px;
                min-height: 70px;
                width: 100%;
                max-width: 280px;
                margin: 5px 0;
            }
            #no-blossom { 
                max-width: 280px;
                width: 100%;
            }
            .date-card { padding: 25px; }
            .date-card h2 { font-size: 2rem; }
        }

        /* iPhone SE and smaller */
        @media (max-width: 375px) {
            .bloom-btn {
                min-width: 180px;
                padding: 14px 25px;
            }
        }
    </style>
</head>
<body>

    <div id="float-container"></div>

    <div class="music-charm" id="music-charm">üéµ</div>

    <div id="cloud-message" class="cloud-message">
        <span>‚ú®</span>
        <span id="cloud-text">psst... click the bloom</span>
    </div>

    <div id="overlay" class="overlay"></div>

    <div id="date-card" class="date-card">
        <div class="pizza-emoji">üçï‚ú®</div>
        <h2>You said Yes! üíñ</h2>
        <div class="date-message">
            <p style="font-size: 1.4rem; margin-bottom: 15px;">My love... üíï</p>
            <p>üìÖ <strong>Book your day for the 16th evening!</strong></p>
            <p>üçï Let's go to <strong>Pizza Buona</strong> ‚Äî I know you love pizza!</p>
            <p>üöè Wait for me at the <strong>campus bus halt</strong> as usual</p>
            <p style="margin-top: 20px; font-size: 1.3rem;">‚ù§Ô∏è Just you, me, and pizza ‚ù§Ô∏è</p>
        </div>
        <button id="close-date" class="close-date">Can't wait! ü•∞</button>
    </div>

    <div class="dream-box">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        
        <div class="creature-circle">
            <img id="soul-gif" src="assets/sappy-sappy-seals.gif" alt="sappy seals ü¶≠">
        </div>

        <div class="whisper-title">
            to my favorite universe
        </div>

        <div id="secret-confession" class="secret-confession">
            üíå Will you be my Valentine? üíï
        </div>

        <div class="button-garden">
            <button id="yes-blossom" class="bloom-btn">yes ‚ù§Ô∏è</button>
            <button id="no-blossom" class="bloom-btn">hmm... no üå±</button>
        </div>
    </div>

    <audio id="sweet-melody" loop preload="auto">
        <source src="music/beabadoobee - Glue Song (Lyrics).mp3" type="audio/mpeg">
    </audio>

    <script>
        // ---------------------------------------------------------
        // IPHONE FIXED - Buttons 100% clickable now!
        // ---------------------------------------------------------
        
        const soulStages = [
            "assets/sappy-sappy-seals.gif",
            "https://media1.tenor.com/m/uDugCXK4vI4AAAAd/chiikawa-hachiware.gif",
            "https://media.tenor.com/f_rkpJbH1s8AAAAj/somsom1012.gif",
            "https://media.tenor.com/OGY9zdREsVAAAAAj/somsom1012.gif",
            "https://media1.tenor.com/m/WGfra-Y_Ke0AAAAd/chiikawa-sad.gif",
            "https://media.tenor.com/CivArbX7NzQAAAAj/somsom1012.gif",
            "https://media.tenor.com/5_tv1HquZlcAAAAj/chiikawa.gif",
            "https://media1.tenor.com/m/uDugCXK4vI4AAAAC/chiikawa-hachiware.gif"
        ];

        const tenderRebukes = [
            "no? ü•∫",
            "baba... üíï",
            "pookie üíó",
            "please? ü•∫",
            "don't üíî",
            "stop üò¢",
            "you're mine üò≠",
            "last chance! üíó",
            "can't catch me üèÉ"
        ];

        const earlyYesWhispers = [
            "try the other bloom first üå∏",
            "click the little 'no' üå±",
            "curious heart! üëÄüíó",
            "one tiny 'no' first üí´",
            "baba... earn the yes üíï",
            "patience, my love üåô"
        ];

        const secretNotes = [
            "I think about you before I fall asleep üòÇüíï",
            "but my heart only beats for you üíï",
            "you make my heart flutter üêæ",
            "you're my favorite hello üíó",
            "I smile when you text üòä",
            "you feel like coming home üè†",
            "loving you is easy üå∏",
            "you're mine üåå",
            "I'd wait forever üí´"
        ];

        let yesCuriosityCount = 0;
        let noHeartbeatCount = 0;
        let runawayHeart = false;
        let melodyPlaying = false;
        let secretIndex = 0;
        
        const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
        const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);

        const soulGif = document.getElementById('soul-gif');
        const yesBlossom = document.getElementById('yes-blossom');
        const noBlossom = document.getElementById('no-blossom');
        const melody = document.getElementById('sweet-melody');
        const cloudMsg = document.getElementById('cloud-message');
        const cloudText = document.getElementById('cloud-text');
        const secretConfession = document.getElementById('secret-confession');
        const musicCharm = document.getElementById('music-charm');
        const dateCard = document.getElementById('date-card');
        const overlay = document.getElementById('overlay');
        const closeDate = document.getElementById('close-date');

        // ---------------------------------------------------------
        // SIMPLE AUDIO - No complications
        // ---------------------------------------------------------
        melody.volume = 0.4;
        
        function initAudio() {
            melody.play()
                .then(() => {
                    melodyPlaying = true;
                    musicCharm.textContent = 'üéµ';
                })
                .catch(() => {
                    musicCharm.textContent = 'üîá';
                });
        }

        // Try to play on load
        initAudio();

        // Play on ANY touch/click
        function startAudioOnTouch() {
            if (!melodyPlaying) {
                melody.play()
                    .then(() => {
                        melodyPlaying = true;
                        musicCharm.textContent = 'üéµ';
                    })
                    .catch(() => {});
            }
        }

        document.body.addEventListener('touchstart', startAudioOnTouch, { once: true });
        document.body.addEventListener('click', startAudioOnTouch, { once: true });

        // Toggle music
        function toggleMelody(e) {
            e.stopPropagation();
            if (melodyPlaying) {
                melody.pause();
                melodyPlaying = false;
                musicCharm.textContent = 'üîá';
            } else {
                melody.play()
                    .then(() => {
                        melodyPlaying = true;
                        musicCharm.textContent = 'üéµ';
                    })
                    .catch(() => {});
            }
        }
        musicCharm.addEventListener('click', toggleMelody);
        musicCharm.addEventListener('touchstart', toggleMelody);

        // ---------------------------------------------------------
        // BUTTON HANDLERS - Direct and simple
        // ---------------------------------------------------------
        
        function handleYesClick(e) {
            e.preventDefault();
            e.stopPropagation();
            
            createSparkle(e.clientX, e.clientY);
            
            if (!runawayHeart) {
                const tease = earlyYesWhispers[Math.min(yesCuriosityCount, earlyYesWhispers.length - 1)];
                yesCuriosityCount++;
                whisperMessage(tease);
                return;
            }
            showDateCard();
        }

        function handleNoClick(e) {
            e.preventDefault();
            e.stopPropagation();
            
            createSparkle(e.clientX, e.clientY);
            
            noHeartbeatCount++;
            
            const msgIndex = Math.min(noHeartbeatCount - 1, tenderRebukes.length - 1);
            noBlossom.textContent = tenderRebukes[msgIndex];
            
            // Grow yes button
            const currentSize = parseFloat(window.getComputedStyle(yesBlossom).fontSize);
            yesBlossom.style.fontSize = (currentSize * 1.2) + 'px';
            yesBlossom.style.padding = `${Math.min(18 + noHeartbeatCount * 3, 60)}px ${Math.min(45 + noHeartbeatCount * 8, 130)}px`;
            
            if (noHeartbeatCount >= 2) {
                const noSize = parseFloat(window.getComputedStyle(noBlossom).fontSize);
                noBlossom.style.fontSize = Math.max(noSize * 0.9, 14) + 'px';
            }
            
            const gifIndex = Math.min(noHeartbeatCount, soulStages.length - 1);
            swapSoul(soulStages[gifIndex]);
            
            revealSecretNote();
            
            // NO BUTTON NEVER RUNS ON iOS!
            if (!isIOS && noHeartbeatCount >= 5 && !runawayHeart) {
                runawayHeart = true;
                whisperMessage("Catch me if you can !!! üèÉüí®üíó");
            }
            
            if (noHeartbeatCount === 8 && isIOS) {
                whisperMessage("Okay okay... will you just say yes? ü•∫üíï");
            }
        }

        // Simple helper functions
        function whisperMessage(msg) {
            cloudText.textContent = msg;
            cloudMsg.classList.add('show');
            clearTimeout(cloudMsg._timer);
            cloudMsg._timer = setTimeout(() => cloudMsg.classList.remove('show'), 2800);
        }

        function createSparkle(x, y) {
            for (let i = 0; i < 3; i++) {
                const spark = document.createElement('span');
                spark.textContent = '‚ú®';
                spark.style.position = 'fixed';
                spark.style.left = (x + (Math.random() - 0.5) * 40) + 'px';
                spark.style.top = (y + (Math.random() - 0.5) * 40) + 'px';
                spark.style.fontSize = Math.random() * 20 + 12 + 'px';
                spark.style.zIndex = '9999';
                spark.style.pointerEvents = 'none';
                spark.className = 'sparkle';
                document.body.appendChild(spark);
                setTimeout(() => spark.remove(), 900);
            }
        }

        function swapSoul(newSrc) {
            soulGif.style.opacity = '0';
            setTimeout(() => {
                soulGif.src = newSrc;
                soulGif.style.opacity = '1';
            }, 220);
        }

        function revealSecretNote() {
            if (noHeartbeatCount >= 1) {
                const noteIndex = Math.min(secretIndex, secretNotes.length - 1);
                secretConfession.innerHTML = 'üíå ' + secretNotes[noteIndex] + ' üíå';
                secretIndex = (secretIndex + 1) % secretNotes.length;
            }
        }

        function showDateCard() {
            overlay.classList.add('show');
            dateCard.classList.add('show');
            soulGif.src = "assets/sappy-sappy-seals.gif";
            whisperMessage("It's a date! üçïüíï I can't wait!");
        }

        function closeDateCard() {
            overlay.classList.remove('show');
            dateCard.classList.remove('show');
        }

        // ---------------------------------------------------------
        // EVENT LISTENERS - Multiple layers for iOS
        // ---------------------------------------------------------
        
        // YES button - multiple event listeners for iOS
        yesBlossom.addEventListener('click', handleYesClick);
        yesBlossom.addEventListener('touchstart', handleYesClick, { passive: false });
        
        // NO button
        noBlossom.addEventListener('click', handleNoClick);
        noBlossom.addEventListener('touchstart', handleNoClick, { passive: false });
        
        // Close date card
        closeDate.addEventListener('click', closeDateCard);
        closeDate.addEventListener('touchstart', closeDateCard);
        overlay.addEventListener('click', closeDateCard);

        // Floating hearts
        function createFloaters() {
            setInterval(() => {
                const heart = document.createElement('span');
                heart.className = 'float-heart';
                heart.style.left = Math.random() * 100 + '%';
                heart.style.animationDuration = Math.random() * 6 + 5 + 's';
                heart.style.fontSize = Math.random() * 20 + 15 + 'px';
                heart.innerHTML = ['üå∏', 'üå∑', 'üíó', '‚ú®', 'üåô', 'ü¶ã', 'üíï', 'üå∫', 'üçï'][Math.floor(Math.random() * 9)];
                document.getElementById('float-container').appendChild(heart);
                setTimeout(() => heart.remove(), 10000);
            }, 500);
        }
        createFloaters();

        // Initial messages
        setTimeout(() => {
            whisperMessage("baba... there's something I've been meaning to tell you üå∑");
        }, 600);
        
        secretConfession.innerHTML = 'üíå Will you be my Valentine? üíï üíå';

        console.log("iOS Mode:", isIOS ? "ACTIVE - No button stays still!" : "Desktop - Button runs!");
    </script>
</body>
</html>